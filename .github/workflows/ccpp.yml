name: C/C++ CI

on: [push, pull_request]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1

    - name: build
      run:  scripts/build_ci.bash

    - name: Check install
      run:  sudo make install && make install-check

    - name: Check style
      run:  make compliant && make shellcheck && make docs-coverage

    - name: Run bat tests
      run:  make -j5 check

    - name: Print status
      if: failure()
      run: cat test-suite.log
